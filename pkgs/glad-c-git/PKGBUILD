pkgname=glad-c-git
_pkgname=glad
pkgver=0.1.33
pkgrel=1
pkgdesc="The opengl c/c++ glad loader generated by the opengl glad loader from the git repo."
arch=('x86_64')
url="https://github.com/Dav1dde/glad"
license=('MIT')
depends=('glibc' 'mesa')
makedepends=('python' 'gcc')
conflicts=('glad')
source=(git://github.com/Dav1dde/glad.git)
sha1sums=('SKIP')


build() {
cd ${_pkgname}
mkdir -p gen
python -m glad --profile core --out-path ./gen --generator c --spec gl
cd gen
gcc -c -fpic src/glad.c -o glad.o -Iinclude
gcc -shared -Wl,-z,relro,-z,now -o libglad.so glad.o
rm glad.o
}

package() {
cd ${_pkgname}
install -D -m755 "$srcdir"/${_pkgname}/gen/libglad.so "$pkgdir"/usr/lib/libglad.so
install -D -m755 "$srcdir"/${_pkgname}/gen/include/glad/glad.h "$pkgdir"/usr/include/glad/glad.h
#install -D -m755 "$srcdir"/${_pkgname}/gen/include/KHR/khrplatform.h "$pkgdir"/usr/include/KHR/khrplatform.h
install -D -m755 "$srcdir"/${_pkgname}/LICENSE "$pkgdir"/usr/share/licenses/glad-c-git/LICENSE
#CMake Integration ( not working? )
#install -D -m755 "$srcdir"/${_pkgname}/gladConfig.cmake "$pkgdir"/usr/lib/cmake/glad/gladConfig.cmake

}
